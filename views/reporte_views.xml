<odoo>
    <data>
        <!-- Vista Kanban Optimizada -->
        <record id="view_electric_asset_management_reporte_kanban" model="ir.ui.view">
            <field name="name">electric.asset.management.reporte.kanban</field>
            <field name="model">electric.asset.management.reporte</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile">
                    <!-- Campos necesarios para el kanban -->
                    <field name="user_id"/>
                    <field name="tipo_reporte"/>
                    <field name="fecha_generacion"/>
                    <field name="estado"/>
                    <field name="prioridad"/>
                    <field name="periodo_inicio"/>
                    <field name="periodo_fin"/>
                    <field name="consumo_total"/>
                    <field name="eficiencia_energetica"/>
                    <field name="objetivos_cumplidos"/>
                    <field name="alerta_eficiencia"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_global_click oe_kanban_card oe_kanban_color_{{ kanban_getcolor(record.prioridad.value) }}"
                                style="border-radius: 8px; padding: 10px; margin: 5px;">
                                <!-- Título -->
                                <div class="o_kanban_record_title d-flex justify-content-between align-items-center mb-2">
                                    <strong><field name="tipo_reporte"/></strong>
                                    <span class="badge"
                                        t-att-class="{
                                            'badge-danger': record.alerta_eficiencia.raw_value === true,
                                            'badge-warning': record.alerta_eficiencia.raw_value === false,
                                            'badge-info': !record.alerta_eficiencia.raw_value
                                        }">
                                        <i class="fa fa-exclamation-circle mr-1" t-if="record.alerta_eficiencia.raw_value"></i>
                                        <t t-if="record.alerta_eficiencia.raw_value">Alerta</t>
                                        <t t-else="">Normal</t>
                                    </span>
                                </div>

                                <!-- Período y Consumo Total -->
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span><field name="periodo_inicio"/> - <field name="periodo_fin"/></span>
                                    <span><strong><field name="consumo_total"/> kWh</strong></span>
                                </div>

                                <!-- Eficiencia Energética -->
                                <div class="mb-2">
                                    <small class="text-muted">Eficiencia:</small>
                                    <field name="eficiencia_energetica" widget="progressbar" options="{'edit': false}" class="mt-1"/>
                                </div>

                                <!-- Prioridad y Estado -->
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span>Prioridad: 
                                        <span t-att-class="{
                                            'text-danger': record.prioridad.value === 'alta',
                                            'text-warning': record.prioridad.value === 'media',
                                            'text-info': record.prioridad.value === 'baja'
                                        }">
                                            <field name="prioridad"/>
                                        </span>
                                    </span>
                                    <span>Estado: 
                                        <span t-att-class="{
                                            'text-secondary': record.estado.value === 'borrador',
                                            'text-primary': record.estado.value === 'generado',
                                            'text-success': record.estado.value === 'enviado'
                                        }">
                                            <field name="estado"/>
                                        </span>
                                    </span>
                                </div>

                                <!-- Objetivos Cumplidos -->
                                <div class="mb-2">
                                    <small>
                                        <i class="fa fa-check-circle text-success mr-1" t-if="record.objetivos_cumplidos.raw_value"></i>
                                        <i class="fa fa-times-circle text-danger mr-1" t-else=""></i>
                                        <t t-if="record.objetivos_cumplidos.raw_value">Objetivos cumplidos.</t>
                                        <t t-else="">Objetivos no cumplidos.</t>
                                    </small>
                                </div>

                                <!-- Fecha de Generación -->
                                <div class="text-right mt-2">
                                    <small class="text-muted"><i class="fa fa-calendar-alt mr-1"></i> <field name="fecha_generacion"/></small>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!-- Vista Formulario Mejorada -->
        <record id="view_electric_asset_management_reporte_form" model="ir.ui.view">
            <field name="name">electric.asset.management.reporte.form</field>
            <field name="model">electric.asset.management.reporte</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <!-- Botones de acción -->
                        <button name="action_generar_reporte_iso50001" string="Generar ISO 50001" type="object" class="btn-primary"
                                attrs="{'invisible': [('estado','!=','borrador')]}"/>
                        <button name="action_enviar_reporte" string="Enviar Reporte" type="object" class="btn-secondary"
                                attrs="{'invisible': ['|', ('estado','!=','generado'), ('contenido','=',False)]}"/>
                        <!-- Estado del reporte -->
                        <field name="estado" widget="statusbar" statusbar_visible="borrador,generado,enviado"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>Reporte de Energía</h1>
                        </div>
                        <group>
                            <group string="Información General">
                                <field name="user_id" string="Usuario"/>
                                <field name="tipo_reporte" placeholder="Seleccione el tipo de reporte"/>
                                <field name="prioridad" placeholder="Seleccione la prioridad"/>
                                <field name="fecha_generacion" string="Fecha de Generación"/>
                                <field name="periodo_inicio" string="Inicio del Período"/>
                                <field name="periodo_fin" string="Fin del Período"/>
                                <field name="politica_energetica" placeholder="Describa la política energética aplicable."/>
                            </group>
                            <group string="Métricas Clave">
                                <field name="consumo_total" string="Consumo Total (kWh)"/>
                                <field name="costos_asociados" string="Costos Asociados"/>
                                <field name="eficiencia_energetica" string="Eficiencia Energética (%)" widget="progressbar"/>
                                <field name="enpi_promedio" string="EnPI Promedio"/>
                                <field name="objetivos_cumplidos" string="Objetivos Cumplidos"/>
                                <field name="desviacion_objetivo" string="Desviación del Objetivo (%)"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Dispositivos Afectados">
                                <field name="dispositivos_afectados" widget="many2many_tags" placeholder="Seleccione los dispositivos afectados"/>
                            </page>
                            <page string="Análisis ISO 50001">
                                <field name="areas_mejora" string="Áreas de Mejora"/>
                                <field name="recomendaciones" string="Recomendaciones" placeholder="Ingrese recomendaciones aquí."/>
                                <field name="acciones_correctivas" string="Acciones Correctivas Propuestas" placeholder="Ingrese acciones correctivas aquí."/>
                                <field name="seguimiento_requerido" string="Requiere Seguimiento" placeholder="Ingrese si el dipositivo nececita seguimiento requerido aquí."/>
                            </page>
                            <page string="Contenido del Reporte">
                                <field name="contenido" string="Contenido" placeholder="Ingrese el contenido del reporte aquí."/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
        <!-- accion y menu para reportes -->
        <record id="action_electric_asset_management_reporte" model="ir.actions.act_window">
            <field name="name">Reportes sobre energia</field>
            <field name="res_model">electric.asset.management.reporte</field>
            <field name="view_mode">kanban,form</field>
            <field name="context">{'search_default_mensual': 1}</field>
        </record>
        <menuitem id="menu_electric_asset_management_reporte" name="Reportes" parent="menu_electric_asset_management_root" action="action_electric_asset_management_reporte"/>
    </data>
</odoo>